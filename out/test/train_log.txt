NEW RUN 2025-07-05-03-49-29
{'n_layer': 6, 'n_embd': 256, 'dim_att': 256, 'dim_ffn': 896, 'pre_ffn': 0, 'head_qk': 0, 'tiny_att_dim': 0, 'tiny_att_layer': -999, 'head_size_a': 64, 'head_size_divisor': 8, 'my_pos_emb': 0, 'my_ffn_shift': 1, 'my_att_shift': 1, 'dropout': 0.0, 'quant': 'none', 'op': 'cuda', 'fused_kernel': False, 'random_seed': -1, 'epoch_steps': 2520, 'epoch_count': 999999, 'epoch_begin': 0, 'epoch_save': 10, 'ctx_len': 4096, 'micro_bsz': 16, 'accelerator': 'gpu', 'strategy': 'deepspeed_stage_2', 'devices': 1, 'num_nodes': 1, 'precision': 'bf16', 'accumulate_grad_batches': 1, 'lr_init': 0.001, 'lr_final': 0.0001, 'warmup_steps': 10, 'beta1': 0.9, 'beta2': 0.99, 'adam_eps': 1e-18, 'weight_decay': 0.001, 'weight_decay_final': -1.0, 'grad_cp': 1, 'layerwise_lr': 1, 'optim': 'none', 'lr_schedule': 'cos', 'gradient_clip_val': 1.0, 'peft': 'none', 'train_parts': ['time', 'ln'], 'lora_config': {'lora_load': '', 'lora_r': 8, 'lora_alpha': 32, 'lora_dropout': 0.01}, 'pissa_config': {'pissa_load': '', 'pissa_init': '', 'pissa_r': 8, 'svd_niter': 4}, 'disha_config': {'mode': 'mode', 'load': '', 'r': 64}, 'dataload': 'pad', 'chunk_ctx': 512, 'loss_mask': 'none', 'mask_id': {'mask0': '0', 'mask1': '1'}, 'data_shuffle': 1, 'avg_loss': 0, 'sft_field': None, 'sft_split': 'train', 'ds_bucket_mb': 200, 'my_sample_len': 0, 'my_qa_mask': 0, 'my_random_steps': 0, 'my_testing': 'x070', 'fla': False, 'train_type': 'none', 'load_partial': 0, 'real_bsz': 16, 'betas': (0.9, 0.99), 'my_timestamp': '2025-07-05-03-49-29', 'model_path': '', 'wandb': '', 'proj_dir': 'out/test', 'data_file': '/mnt/g/Projects/MachineLearning/block-blm/data/block_blm_partial_data_device_0', 'data_type': 'binidx', 'vocab_size': 256, 'my_exit': 99999999, 'my_exit_tokens': 16332356, 'magic_prime': 3947, 'lora_load': '', 'pissa_load': '', 'pissa_init': '', 'disha_load': '', 'quant_path': '', 'my_pile_version': 1, 'my_pile_stage': 2, 'my_pile_shift': -1, 'my_pile_edecay': 0, 'my_pile_prev_p': None, 'load_model': 'out/test/rwkv-init.pth'}
{'zero_allow_untested_optimizer': True, 'zero_optimization': {'stage': 2, 'contiguous_gradients': True, 'overlap_comm': True, 'allgather_partitions': True, 'reduce_scatter': True, 'allgather_bucket_size': 200000000, 'reduce_bucket_size': 200000000, 'sub_group_size': 1000000000000}, 'activation_checkpointing': {'partition_activations': False, 'cpu_checkpointing': False, 'contiguous_memory_optimization': False, 'synchronize_checkpoint_boundary': False}, 'aio': {'block_size': 1048576, 'queue_depth': 8, 'single_submit': False, 'overlap_events': True, 'thread_count': 1}, 'gradient_accumulation_steps': 1, 'train_micro_batch_size_per_gpu': 16, 'gradient_clipping': 1.0, 'bf16': {'enabled': True}}
NEW RUN 2025-07-05-04-09-58
{'n_layer': 6, 'n_embd': 256, 'dim_att': 256, 'dim_ffn': 896, 'pre_ffn': 0, 'head_qk': 0, 'tiny_att_dim': 0, 'tiny_att_layer': -999, 'head_size_a': 64, 'head_size_divisor': 8, 'my_pos_emb': 0, 'my_ffn_shift': 1, 'my_att_shift': 1, 'dropout': 0.0, 'quant': 'none', 'op': 'cuda', 'fused_kernel': False, 'random_seed': -1, 'epoch_steps': 2520, 'epoch_count': 999999, 'epoch_begin': 0, 'epoch_save': 10, 'ctx_len': 4096, 'micro_bsz': 16, 'accelerator': 'gpu', 'strategy': 'deepspeed_stage_2', 'devices': 1, 'num_nodes': 1, 'precision': 'bf16', 'accumulate_grad_batches': 1, 'lr_init': 0.001, 'lr_final': 0.0001, 'warmup_steps': 10, 'beta1': 0.9, 'beta2': 0.99, 'adam_eps': 1e-18, 'weight_decay': 0.001, 'weight_decay_final': -1.0, 'grad_cp': 1, 'layerwise_lr': 1, 'optim': 'none', 'lr_schedule': 'cos', 'gradient_clip_val': 1.0, 'peft': 'none', 'train_parts': ['time', 'ln'], 'lora_config': {'lora_load': '', 'lora_r': 8, 'lora_alpha': 32, 'lora_dropout': 0.01}, 'pissa_config': {'pissa_load': '', 'pissa_init': '', 'pissa_r': 8, 'svd_niter': 4}, 'disha_config': {'mode': 'mode', 'load': '', 'r': 64}, 'dataload': 'pad', 'chunk_ctx': 512, 'loss_mask': 'none', 'mask_id': {'mask0': '0', 'mask1': '1'}, 'data_shuffle': 1, 'avg_loss': 0, 'sft_field': None, 'sft_split': 'train', 'ds_bucket_mb': 200, 'my_sample_len': 0, 'my_qa_mask': 0, 'my_random_steps': 0, 'my_testing': 'x070', 'fla': False, 'train_type': 'none', 'load_partial': 0, 'real_bsz': 16, 'betas': (0.9, 0.99), 'my_timestamp': '2025-07-05-04-09-58', 'model_path': '', 'wandb': '', 'proj_dir': 'out/test', 'data_file': '/mnt/g/Projects/MachineLearning/block-blm/data/block_blm_partial_data_device_0', 'data_type': 'binidx', 'vocab_size': 256, 'my_exit': 99999999, 'my_exit_tokens': 16332356, 'magic_prime': 3947, 'lora_load': '', 'pissa_load': '', 'pissa_init': '', 'disha_load': '', 'quant_path': '', 'my_pile_version': 1, 'my_pile_stage': 2, 'my_pile_shift': -1, 'my_pile_edecay': 0, 'my_pile_prev_p': None, 'load_model': 'out/test/rwkv-init.pth'}
{'zero_allow_untested_optimizer': True, 'zero_optimization': {'stage': 2, 'contiguous_gradients': True, 'overlap_comm': True, 'allgather_partitions': True, 'reduce_scatter': True, 'allgather_bucket_size': 200000000, 'reduce_bucket_size': 200000000, 'sub_group_size': 1000000000000}, 'activation_checkpointing': {'partition_activations': False, 'cpu_checkpointing': False, 'contiguous_memory_optimization': False, 'synchronize_checkpoint_boundary': False}, 'aio': {'block_size': 1048576, 'queue_depth': 8, 'single_submit': False, 'overlap_events': True, 'thread_count': 1}, 'gradient_accumulation_steps': 1, 'train_micro_batch_size_per_gpu': 16, 'gradient_clipping': 1.0, 'bf16': {'enabled': True}}
